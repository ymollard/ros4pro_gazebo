
<!DOCTYPE HTML>
<html lang="fr" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>E.DO · ROS4PRO</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../ergo-jr/" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Tapez pour rechercher" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Qu'est-ce que c'est ?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../introduction/">
            
                <a href="../../introduction/">
            
                    
                    I. Introduction à Linux et ROS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    II. Navigation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../navigation/turtlebot/">
            
                <a href="../../navigation/turtlebot/">
            
                    
                    Turtlebot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    III. Manipulation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.1" data-path="./">
            
                <a href="./">
            
                    
                    E.DO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../ergo-jr/">
            
                <a href="../ergo-jr/">
            
                    
                    Poppy Ergo Jr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../sawyer/">
            
                <a href="../sawyer/">
            
                    
                    Sawyer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../ur/README.md">
            
                <span>
            
                    
                    Universal Robot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    IV. Perception
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../perception/opencv/">
            
                <a href="../../perception/opencv/">
            
                    
                    OpenCV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../perception/keras/">
            
                <a href="../../perception/keras/">
            
                    
                    Keras
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../perception/pytorch/">
            
                <a href="../../perception/pytorch/">
            
                    
                    Torch
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    V. Intégration
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../integration/ergo-tb-keras/">
            
                <a href="../../integration/ergo-tb-keras/">
            
                    
                    Poppy Ergo Jr + Turtlebot + Keras
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../integration/sawyer-tb-keras/">
            
                <a href="../../integration/sawyer-tb-keras/">
            
                    
                    Sawyer + Turtlebot + Keras
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../theory/">
            
                <a href="../../theory/">
            
                    
                    VI. Robotique théorique
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    VII. Simulation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../simulation/gazebo/">
            
                <a href="../../simulation/gazebo/">
            
                    
                    Gazebo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Foires aux Questions
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../faq/pi/">
            
                <a href="../../faq/pi/">
            
                    
                    FAQ robots basés sur Raspberry Pi
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Publié avec GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >E.DO</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="iii-robotique-de-manipulation-avec-edo">III. Robotique de manipulation avec E.DO</h1>
<p>La robotique de manipulation regroupe la manipulation d&apos;objets avec des robots : des bras articul&#xE9;s &#xE0; 5 ou 6 axes, les robots <a href="https://en.wikipedia.org/wiki/SCARA" target="_blank">SCARA</a> (Selective Compliance Assembly Robot Arm), les robots <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_robot" target="_blank">cart&#xE9;siens</a> (lin&#xE9;aires), les robots <a href="https://en.wikipedia.org/wiki/Parallel_manipulator" target="_blank">parall&#xE8;les</a> ... Dans ce TP nous utilisons un robot <a href="https://edo.cloud/" target="_blank">E.DO du fabriquant Comau</a>.</p>
<h2 id="pr&#xE9;requis">Pr&#xE9;requis</h2>
<ul>
<li>Lyc&#xE9;e et +</li>
<li>Notions de commandes dans un terminal et d&apos;adressage IP</li>
<li>Le <a href="../introduction">TP d&apos;introduction</a></li>
<li>Ce TP est compatible avec la simulation si vous n&apos;avez pas d&apos;E.DO : sauter directement au 2.3.bis</li>
</ul>
<h2 id="diapositives">Diapositives</h2>
<p><div class="pdf">
                                
                <div class="pdf__link"><a target="_blank" href="https://files.ros4.pro/manipulation.pdf">View PDF</a></div>
                
                                <object data="https://files.ros4.pro/manipulation.pdf" width="100%" height="565px" type="application/pdf">
                                    <embed src="https://files.ros4.pro/manipulation.pdf">
                                        <p>
                                            This browser does not support PDFs. <br>
                                            Please download the PDF to view it: <a target="_blank" href="https://files.ros4.pro/manipulation.pdf">Download PDF</a>.
                                        </p>
                                    
                                </object>
                            </div></p>
<h2 id="1-pr&#xE9;parer-le-mat&#xE9;riel">1. Pr&#xE9;parer le mat&#xE9;riel</h2>
<p>&#x1F50C; Votre E.DO comporte un connecteur Ethernet sur la base, c&apos;est sur ce connecteur que vous pouvez connecter un c&#xE2;ble r&#xE9;seau. Nous vous conseillons de brancher un c&#xE2;ble RJ45 entre le robot et votre ordinateur pour commencer.Plus tard vous pourrez aussi vous connecter au point d&apos;acc&#xE8;s Wifi du robot pour communiquer en sans-fil.</p>
<p>A l&apos;int&#xE9;rieur de la base se trouve une Raspberry Pi et une carte SD pr&#xE9;configur&#xE9;e par le fabriquant, elle est accessible en d&#xE9;vissant les trappes. Votre robot est donc compatible avec la plupart des proc&#xE9;dures de la <a href="../../faq/pi">FAQ Raspberry Pi</a>. </p>
<p>&#x26A0;&#xFE0F; Le robot peut &#xEA;tre vendu avec plusieurs mod&#xE8;les d&apos;effecteurs (= pince) ou bien sans effecteur du tout. Ce TP pr&#xE9;suppose que vous avez la version avec la pince &#xE0; 2 &#xE9;tats : ouvert et ferm&#xE9;.</p>
<h3 id="11-changer-ladresse-ip-de-lordinateur-ros">1.1 Changer l&apos;adresse IP de l&apos;ordinateur ROS</h3>
<p>E.DO est livr&#xE9; pr&#xE9;configur&#xE9; avec son propre r&#xE9;seau IP. Veuillez &#xE9;diter la configuration r&#xE9;seau Ethernet (c&#xE2;bl&#xE9;) de votre ordinateur Ubuntu en utilisant le gestionnaire r&#xE9;seau (network manager, en haut &#xE0; droite, vers l&apos;horloge). Attribuez la configuration IP fixe suivante :</p>
<ul>
<li>Adresse IP statique <code>10.42.0.1</code></li>
<li>Masque de sous-r&#xE9;seau <code>24</code> ou bien <code>255.255.255.0</code></li>
</ul>
<p>&#x26A0;&#xFE0F; Attention, si vous souhaitez disposer aussi d&apos;une connexion &#xE0; Internet, cela ne focntionnera plus &#xE0; cause du changement d&apos;adresse IP. Vous pouvez cependant connecter votre ordinateur &#xE0; un r&#xE9;seau Wifi pour disposer aussi d&apos;un acc&#xE8;s Internet.</p>
<h3 id="12-pinguer-le-robot">1.2 Pinguer le robot</h3>
<p>Mettez votre robot sous-tension puis depuis un terminal Ubuntu tapez <code>ping 10.42.0.49</code>. Si tout va bien, un message apparaitra chaque seconde en indiquant le d&#xE9;lai de communication avec le robot en millisecondes (ms), jsuqu&apos;&#xE0; ce que vous l&apos;interompiez avec Ctrl + C :</p>
<pre><code class="lang-bash">$ ping 10.42.0.49
PING 10.42.0.49 (10.42.0.49) 56(84) bytes of data.
64 bytes from 10.42.0.49: icmp_seq=1 ttl=114 time=3.7 ms
64 bytes from 10.42.0.49: icmp_seq=2 ttl=114 time=5.6 ms
^C
</code></pre>
<p>Si un message d&apos;erreur s&apos;affichage &#xE0; la place du d&#xE9;lai en millisecondes, vous avez un probl&#xE8;me r&#xE9;seau. V&#xE9;rifiez l&apos;&#xE9;tape 1.1 et que votre robot a bien d&#xE9;marr&#xE9; avec sa configuraiton r&#xE9;seau d&apos;origine. Si vous voyez les d&#xE9;lais en millisecondes, vous pouvez continuer.</p>
<h3 id="13-configurer-lenvironnement-ros-du-robot">1.3. Configurer l&apos;environnement ROS du robot</h3>
<p>&#x1F4BB; Avec SSH, connectez-vous &#xE0; la Raspberry Pi du robot :</p>
<pre><code class="lang-bash">ssh edo@10.42.0.49
</code></pre>
<p>Le mot de passe par d&#xE9;faut est <code>raspberry</code>.</p>
<p>Si la connexion est un succ&#xE8;s vous deviez voir un message d&apos;information italien <code>comandi tmux</code> &#x1F1EE;&#x1F1F9; avec quelques explications &#xE0; propos de rostopic, que nous devez conna&#xEE;tre puisqu nous l&apos;d&#xE9;j&#xE0; abord&#xE9;e dans l&apos;<a href="../../introduction">introduction</a>. Si ce message n&apos;apparait pas, v&#xE9;rifiez la configuration r&#xE9;seau du titre 1.1.</p>
<p>&#x1F916; Avec la commande nano, &#xE9;ditez ensuite le script <code>ministarter</code> du robot via SSH :</p>
<pre><code>nano ~/ministarter
</code></pre><p>&#x1F916; Descendez avec les fl&#xE8;ches du clavier pour identifier ces deux lignes :</p>
<pre><code>export ROS_MASTER_URI=http://192.168.12.1:11311
export ROS_IP=192.168.12.1
</code></pre><p>puis remplacez-les par ces 2 lignes modifi&#xE9;es :</p>
<pre><code>export ROS_MASTER_URI=http://10.42.0.49:11311
export ROS_IP=10.42.0.49
</code></pre><p>Quittez en tapant <code>Ctrl-X</code>, puis <code>y</code> et <code>Entr&#xE9;e</code> pour valider le nom de fichier et l&apos;enregistrer.</p>
<p>&#x1F916; Tapez ensuite <code>sudo reboot</code> pour red&#xE9;marrer le robot et attendez qu&apos;il soit de nouveau pr&#xEA;t.</p>
<p>&#x26A0;&#xFE0F; Il n&apos;est n&#xE9;cessaire de configurer l&apos;environnement ROS qu&apos;une seule fois sur chaque nouveau robot, car la nouvelle configuration est ensuite enregistr&#xE9;e d&#xE9;finitivement sur la carte SD de la Raspberry Pi internet &#xE0; E.DO.</p>
<h3 id="14-configurer-lenvironnement-ros-de-lordinateur">1.4 Configurer l&apos;environnement ROS de l&apos;ordinateur</h3>
<p>&#x1F4C0;&#x1F4BB; Pour installer tous les packages ROS n&#xE9;cessaires sur votre ordinateur, ex&#xE9;cutez les commandes suivantes :</p>
<pre><code class="lang-bash">roscd &amp;&amp; <span class="hljs-built_in">cd</span> src
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_control_v3.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_moveit.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_description.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_core_msgs.git
pip install getkey numpy
<span class="hljs-built_in">cd</span> ..
catkin_make
</code></pre>
<p>Un script de d&#xE9;marrage nomm&#xE9; <a href="https://github.com/eDO-community/eDO_control_v3/blob/master/start.bash" target="_blank"><code>start.bash</code></a> configure les variables d&apos;environnement our vous &#xE0; chque fois que vous devrez travailler avec votre E.DO. Ce script ajoute un pr&#xE9;fixe jaune devant l&apos;invite de commande pour savoir quel est le ROS master actuellement s&#xE9;lectionn&#xE9;.</p>
<p>&#x1F4C0;&#x1F4BB; Pour ex&#xE9;cutez ce script tapez :</p>
<pre><code class="lang-bash">roscd edo_control
./start.bash
</code></pre>
<p>Vous devriez voir appara&#xEE;tre en pr&#xE9;fixe le ROS master de votre E.DO, avant de taper toute autre commande ROS, comme ci-dessous. Essayez un <code>rostopic echo</code> pour v&#xE9;rifier si tout va bien :</p>
<pre><code class="lang-bash">[http://10.42.0.49:11311] me@workstation :~$ rostopic <span class="hljs-built_in">echo</span> /machine_state -n1
current_state: 0
opcode: 0
</code></pre>
<p>Les valeurs <code>current_state: 0</code> et <code>opcode: 0</code> indiquent l&apos;&#xE9;tat actuel du robot, dans un topic ROS d&#xE9;di&#xE9; nomm&#xE9; <code>/machine_state</code>. Si vous ne voyez pas ces deux valeurs en tapant la commande, vous pourriez avoir un probl&#xE8;me de r&#xE9;seau ou de configuration ROS.</p>
<h2 id="2-travaux-pratique">2. Travaux pratique</h2>
<h3 id="21-calibrer-le-robot">2.1. Calibrer le robot</h3>
<p><strong>Pourquoi calibrer ?</strong> Chacun des joints (axes moteurs) de votre robot poss&#xE8;de un encodeur : un capteur permettant au moteur de d&#xE9;terminer sa position angulaire courante (par exemple tourn&#xE9; &#xE0; 90&#xB0; ou &#xE0; 150&#xB0;, etc). Plusieurs technologies d&apos;encodeurs existent ayant chacune des avantages et inconv&#xE9;nients. Un des inconv&#xE9;nients des encodeurs d&apos;E.DO est qu&apos;ils ne peuvent mesurer que des d&#xE9;placements angulaires relatifs &#xE0; leur angle de d&#xE9;marrage, mais ne savent pas o&#xF9; est l&apos;angle 0&#xB0;. Vous ne pouvez pas commander un moteur d&apos;aller en position 90&#xB0; s&apos;il ne sait pas o&#xF9; et le 0&#xB0;. L&apos;&#xE9;tape de calibration sert &#xE0; indique au robot o&#xF9; sont les angles de r&#xE9;f&#xE9;rence 0&#xB0; de chacun de ses moteurs, un par un.</p>
<p><strong>Quand calibrer ?</strong> Vous devrez calibrer votre robot apr&#xE8;s chaque cycle de marche-arr&#xEA;t. La raison pour cela est que seule une partie des moteurs poss&#xE8;dent des freins, pour &#xE9;viter q&apos;ils se d&#xE9;calibrent en &#xE9;tant &#xE0; l&apos;arr&#xEA;t. En effet, si vos moteurs sont &#xE0; l&apos;arr&#xEA;t et sans frein les emp&#xEA;chant de tourner, la gravit&#xE9; ou une action humaine pourrait les faire tourner malgr&#xE9; eux, sans qu&apos;ils puissent enregistrer ces rotations puisqu&apos;ils ne sont pas sous tension. Ils perdraient ainsi la trace de leur angle 0&#xB0;. Il faut donc calibrer &#xE0; chaque d&#xE9;marrage, ou alors s&apos;assurer qu&apos;aucun des moteurs ne bouge pendant que le robot n&apos;est pas sous tension, ce qui est difficile &#xE0; s&apos;assurer sans frein. </p>
<p><strong>Comment calibrer ?</strong> E.DO est livr&#xE9; avec une application Android, permettant nottamment de le calibrer. Le constructeur fournit une application Android permettant entre autre de calibrer le robot. Vous pourriez utiliser cette application mais puisque nous sommes sur un TP ROS, nous allons le faire avec ROS.</p>
<p>&#x1F4BB; D&#xE9;marrez la proc&#xE9;dure de calibration en tapant :</p>
<pre><code class="lang-bash"> roslaunch edo_control calibrate.launch
</code></pre>
<p>Vous devirez d&apos;avord voir un message d&apos;avertissement <code>JOINT_UNCALIBRATED</code> qui indique que les joints ne sont effectivement pas calibr&#xE9;s, et qui d&#xE9;taille la proc&#xE9;dure de calibration en anglais. Suivez cette proc&#xE9;dure jusqu&apos;au bout.</p>
<p>A chaque fois que vous voyez <code>Calibrating joint X</code> cela signifie que la proc&#xE9;dure va calibrer le joint X. Pour chaque joint appuyez sur les touches gauche et droite pour aligner physiquement les marqueurs d&apos;alignement de chaque moteur. Une fois que votre joint est calibr&#xE9; appuyez sur Entr&#xE9;e pour passer au suivant.</p>
<p>&#x2139;&#xFE0F; La position 0&#xB0; calibr&#xE9;e de chaque joint doit conduire petit-&#xE0;-petit votre robot &#xE0; se tenir droit comme un i. Si &#xE0; la fin de la calibration votre robot n&apos;est pas droit comme un i pointant vers le plafond, vous vous &#xEA;tes tromp&#xE9; sur l&apos;alignement d&apos;un ou plusieurs moteurs, vous pouvez relancer la proc&#xE9;dure.</p>
<p>La commande de calibration se ferme d&apos;elle-m&#xEA;me lorsque tous les joints ont &#xE9;t&#xE9; calibr&#xE9;s.</p>
<h3 id="22-d&#xE9;marrer-le-contr&#xF4;le-du-robot-et-ouvrirfermer-la-pince">2.2. D&#xE9;marrer le contr&#xF4;le du robot et ouvrir/fermer la pince</h3>
<p>&#x1F4BB; Lancez le launchfile de contr&#xF4;le du robot sur votre ordinateur :</p>
<pre><code class="lang-bash"> roslaunch edo_control control.launch
</code></pre>
<p>Cela va activer les interfaces de communication suivant avec le robot :</p>
<ul>
<li>Le topic <code>/joint_states</code>, qui affiche tout l&apos;&#xE9;tat des joints &#xE0; environ 90 Hz : positions angulaires, vitesses et torques</li>
<li>Le serveur d&apos;action <code>/follow_joint_trajectory</code> qui permettra d&apos;ex&#xE9;cuter des trajectoires avec MoveIt un peu plus tard dans le TP</li>
<li>Le topic <code>/open_gripper</code> qui permet d&apos;ouvrir et de ferme la pince</li>
</ul>
<p><strong>Tester la commande de la pince</strong> : Sur ce dernier topic, vous pouvez publier <code>true</code> pour ouvrir la pince (course maximale de 60 mm) et <code>false</code> pour la fermer (course minimale de 0 mm).</p>
<p>&#x1F4BB; Conservez le contr&#xF4;le du robot d&#xE9;marr&#xE9; dans un terminal. Dans un autre terminal testez l&apos;ouverture de la pince avec <code>rostopic</code> :</p>
<pre><code>rostopic pub /open_gripper std_msgs/Bool &quot;data: true&quot;
</code></pre><p>Remplacez <code>true</code> par <code>false</code> pour refermer la pince !</p>
<h3 id="23-d&#xE9;marrer-moveit-pour-planifier-des-trajectoires-avec-un-robot-r&#xE9;el">2.3. D&#xE9;marrer MoveIt pour planifier des trajectoires (avec un robot r&#xE9;el)</h3>
<p>&#x1F4BB; Conservez le contr&#xF4;le du robot d&#xE9;marr&#xE9; dans un terminal. Tapez la commande suivante pour d&#xE9;marrer MoveIt avec E.DO :</p>
<pre><code class="lang-bash">roslaunch edo_moveit demo.launch
</code></pre>
<p>Vous devriez voir l&apos;interface de MoveIt qui d&#xE9;marre dans RViz similairement &#xE0; la capture d&apos;&#xE9;cran ci-dessous :</p>
<p><img src="https://raw.githubusercontent.com/eDO-community/eDO_moveit/master/img/screen.png" alt="MoveIt avec E.DO"></p>
<p>Utilisez ensuite les outils MoveIt pour <strong>planifier et ex&#xE9;cuter des trajectoires sur votre robot</strong> :</p>
<ol>
<li>Dans la zone <code>Motion Planning</code> en bas &#xE0; gauche de RViz, s&#xE9;lectionnez l&apos;onglet <code>Planning</code></li>
<li>Dans la vue 3D du robot, bougez la balle bleue correspondant &#xE0; l&apos;effecteur (la pince) quelque part dans l&apos;espace autour du robot</li>
<li>Le robot orange correspond &#xE0; la configuration cible que vous allez demander d&apos;atteindre &#xE0; votre robot</li>
<li>Cliquez sur <code>Plan and Execute</code> pour planifier une trajectoire vers cette cible et l&apos;ex&#xE9;cuter sur le robot r&#xE9;el</li>
</ol>
<p>Si vous ne voyez pas votre vrai robot bouger, v&#xE9;rifier dans le terminal &#xE0; partir duquel vous avez d&#xE9;marr&#xE9; MoveIt : il se peut que des messages d&apos;erreurs apparaissent en rouge pour vous aider &#xE0; localiser le probl&#xE8;me.</p>
<p>Ce TP s&apos;arr&#xEA;te ici mais il est possible d&apos;ajouter des &#xE9;l&#xE9;ments de collision (obstacles) que le planificateur de trajectoire contournera. Pour ce faire vous pouvez charger un fichier comprenant les coordonn&#xE9;es des obstacles dans l&apos;onglet <code>Scene Objects</code> de la zone <code>Motion Planning</code> ou bien pour le faire via Python vous pouvez vous inspirer de la partie de d&#xE9;claration des obstacles de cet <a href="../ergo-jr#233-d&#xE9;clarer-des-obstacles">autre TP</a>.</p>
<h4 id="que-faire-si-les-freins-des-moteurs-sactivent-al&#xE9;atoirement-pendant-le-mouvement">Que faire si les freins des moteurs s&apos;activent al&#xE9;atoirement pendant le mouvement</h4>
<p>Si vos trajectoires sont interrompues par des activations intempestives des freins (suivies d&apos;une d&#xE9;sactivation), v&#xE9;rifiez d&apos;abord que votre robot a &#xE9;t&#xE9; calibr&#xE9; avec pr&#xE9;cision. Si c&apos;est le cas, cela signifie que votre robot subit trop de force pour ex&#xE9;cuter le mouvement que vous lui demander. Le syst&#xE8;me de s&#xE9;curit&#xE9; active donc les freins. Ralentissez les vitesses des joints dans <a href="https://github.com/eDO-community/eDO_moveit/blob/master/config/joint_limits.yaml" target="_blank"><code>kinematics.yaml</code></a> ou bien all&#xE9;ger le poids de votre robot ou bien demandez une position cible qui fera moins forcer les moteurs.</p>
<h3 id="23bis-d&#xE9;marrer-moveit-pour-planifier-des-trajectoires-avec-un-robot-simul&#xE9;">2.3.bis. D&#xE9;marrer MoveIt pour planifier des trajectoires (avec un robot simul&#xE9;)</h3>
<p>&#x1F4C0;&#x1F4BB; Pour installer tous les packages ROS n&#xE9;cessaires sur votre ordinateur et travailler avec un robot simul&#xE9;, il ne faut pas avoir configur&#xE9; l&apos;environnement d&#xE9;crit en 1.4, ex&#xE9;cutez directement les commandes suivantes :</p>
<pre><code class="lang-bash">roscd &amp;&amp; <span class="hljs-built_in">cd</span> src
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_control_v3.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_moveit.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_description.git
git <span class="hljs-built_in">clone</span> https://github.com/eDO-community/eDO_core_msgs.git
roscd &amp;&amp; catkin_make
<span class="hljs-built_in">source</span> ~/.bashrc
</code></pre>
<p>&#x1F4BB; Enfin, cette commande ci-dessous lancera MoveIt avec un E.DO simul&#xE9; :</p>
<pre><code class="lang-bash">roslaunch edo_moveit demo.launch simulated:=<span class="hljs-literal">true</span>
</code></pre>
<p>Vous devriez voir l&apos;interface de MoveIt qui d&#xE9;marre dans RViz similairement &#xE0; la capture d&apos;&#xE9;cran ci-dessous :</p>
<p><img src="https://raw.githubusercontent.com/eDO-community/eDO_moveit/master/img/screen.png" alt="MoveIt avec E.DO"></p>
<p>Utilisez ensuite les outils MoveIt pour planifier et ex&#xE9;cuter des trajectoires sur votre robot simul&#xE9; :</p>
<ol>
<li>Dans la zone <code>Motion Planning</code> en bas &#xE0; gauche de RViz, s&#xE9;lectionnez l&apos;onglet <code>Planning</code></li>
<li>Dans la vue 3D du robot, bougez la balle bleue correspondant &#xE0; l&apos;effecteur (la pince) quelque part dans l&apos;espace autour du robot</li>
<li>Le robot orange correspond &#xE0; la configuration cible que vous allez demander d&apos;atteindre &#xE0; votre robot</li>
<li>Cliquez sur <code>Plan and Execute</code> pour planifier une trajectoire vers cette cible et l&apos;ex&#xE9;cuter sur le robot simul&#xE9;</li>
</ol>
<p>Ce TP s&apos;arr&#xEA;te ici mais il est possible d&apos;ajouter des &#xE9;l&#xE9;ments de collision (obstacles) que le planificateur de trajectoire contournera. Pour ce faire vous pouvez charger un fichier comprenant les coordonn&#xE9;es des obstacles dans l&apos;onglet <code>Scene Objects</code> de la zone <code>Motion Planning</code> ou bien pour le faire via Python vous pouvez vous inspirer de la partie de d&#xE9;claration des obstacles de cet <a href="../ergo-jr#233-d&#xE9;clarer-des-obstacles">autre TP</a>.
<div id="page-footer" class="localized-footer"><hr><p><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Cc-by-nc-sa_euro_icon.svg/120px-Cc-by-nc-sa_euro_icon.svg.png" alt="CC-BY-NC-SA"></a></p>
<h4 id="&#x1F4DA;-auteurs">&#x1F4DA; Auteurs</h4>
<p>Jessica Colombel (<a href="http://inria.fr/" target="_blank">Inria</a>), R&#xE9;mi Fabre (<a href="https://robotics.catie.fr/" target="_blank">CATIE</a>), Jean-Baptiste Horel (<a href="https://robotics.catie.fr/" target="_blank">CATIE</a>), Yoan Mollard (<a href="https://robot-enseirb-matmeca.fr/" target="_blank">Bordeaux INP</a>), Alexandre P&#xE9;r&#xE9; (<a href="https://flowers.inria.fr" target="_blank">Inria</a>), Steve N&apos;Guyen (<a href="https://www.labri.fr/" target="_blank">LaBRI</a>) .</p>
<h4 id="&#x1F4AC;-besoin-daide-">&#x1F4AC; Besoin d&apos;aide ?</h4>
<p>Posez votre question sur le <a href="https://discourse.ros.org/c/local/france/48" target="_blank">forum francophone des utilisateurs de ROS</a>.</p>
<p>&#x1F4C5;  Derni&#xE8;re mise &#xE0; jour : 2021-01-03T19:14:24+01:00</p>
<!-- Default to night theme -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" defer>
$("div").first().addClass("color-theme-2");
</script></div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="../ergo-jr/" class="navigation navigation-next navigation-unique" aria-label="Next page: Poppy Ergo Jr">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"E.DO","level":"1.4.1","depth":2,"next":{"title":"Poppy Ergo Jr","level":"1.4.2","depth":2,"path":"manipulation/ergo-jr/README.md","ref":"manipulation/ergo-jr/README.md","articles":[]},"previous":{"title":"III. Manipulation","level":"1.4","depth":1,"ref":"","articles":[{"title":"E.DO","level":"1.4.1","depth":2,"path":"manipulation/edo/README.md","ref":"manipulation/edo/README.md","articles":[]},{"title":"Poppy Ergo Jr","level":"1.4.2","depth":2,"path":"manipulation/ergo-jr/README.md","ref":"manipulation/ergo-jr/README.md","articles":[]},{"title":"Sawyer","level":"1.4.3","depth":2,"path":"manipulation/sawyer/README.md","ref":"manipulation/sawyer/README.md","articles":[]},{"title":"Universal Robot","level":"1.4.4","depth":2,"path":"manipulation/ur/README.md","ref":"manipulation/ur/README.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-search","search-plus","github","anchorjs","build","custom-favicon","language-picker","localized-footer","embed-pdf"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"language-picker":{"grid-columns":3},"github":{"url":"https://github.com/ros4pro/"},"localized-footer":{"filename":"FOOTER.md","hline":"true"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"build":{"args":[],"bin":"pandoc","format":"latex","opts":{},"output":"_book/main.tex","template":"_layouts/main.tex"},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"favicon":"img/favicon.ico","custom-favicon":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{},"embed-pdf":{},"search-plus":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"ROS4PRO","language":"fr","gitbook":"*"},"file":{"path":"manipulation/edo/README.md","mtime":"2021-01-03T18:14:24.824Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-01-03T18:20:09.115Z"},"basePath":"../..","book":{"language":"fr"}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

